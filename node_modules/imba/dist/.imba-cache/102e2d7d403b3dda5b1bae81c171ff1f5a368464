{"js":{"code":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};;\nfunction inheritClass$__(cls){\n\tObject.getPrototypeOf(cls.prototype).constructor?.inherited?.(cls);\n};\nimport {accessor as imba_accessor} from 'imba';\nvar $1 = Symbol('name'), $2 = Symbol(), $3 = Symbol(), $4 = Symbol('id'), $5 = Symbol(), $6 = Symbol('parent'), $7 = Symbol(), $8 = Symbol('offset'), $9 = Symbol(), $10 = Symbol('num'), $11 = Symbol(), $12 = Symbol(), $14, $16, $17, $18, $19;\nconst $__init__$ = Symbol.for('#__init__'), $__patch__$ = Symbol.for('#__patch__'), $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport setup from '../setup';\n\nclass Scrim extends OPObject {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $13;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($13 = $$.name) !== undefined && this.ααname.$init($13,this,$1,'name',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$3 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααname.$init($$ ? $$.name : undefined,this,$1,'name',$$);\n\t\t\n\t}\n\tset name(val){ this.ααname.$set(val,this,$1,'name') }\n\tget name(){ return this.ααname.$get(this,$1,'name') }\n\tget ααname(){ return this[$2] || imba_accessor(($14 = this.αstring(),$14),this,$1,'name',$2,Scrim.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $3;defineName$__(this,'Scrim');this.alias = 's';\n\t\tinheritClass$__(this);}\n};\n\n// If no object inherits from this we should not even include\n// parent and offset as fields in postgrs?\nclass Clip extends OPObject {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $15;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($15 = $$.id) !== undefined && this.ααid.$init($15,this,$4,'id',$$);\n\t\tfields && ($15 = $$.parent) !== undefined && this.ααparent.$init($15,this,$6,'parent',$$);\n\t\tfields && ($15 = $$.offset) !== undefined && this.ααoffset.$init($15,this,$8,'offset',$$);\n\t\tfields && ($15 = $$.num) !== undefined && this.ααnum.$init($15,this,$10,'num',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$12 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααid.$init($$ ? $$.id : undefined,this,$4,'id',$$);\n\t\tfields && this.ααparent.$init($$ ? $$.parent : undefined,this,$6,'parent',$$);\n\t\tfields && this.ααoffset.$init($$ ? $$.offset : undefined,this,$8,'offset',$$);\n\t\tfields && this.ααnum.$init($$ ? $$.num : undefined,this,$10,'num',$$);\n\t\t\n\t}\n\tset id(val){ this.ααid.$set(val,this,$4,'id') }\n\tget id(){ return this.ααid.$get(this,$4,'id') }\n\tget ααid(){ return this[$5] || imba_accessor(($16 = this.αkey(this.ααparent,this.ααoffset),$16),this,$4,'id',$5,Clip.prototype) }\n\tset parent(val){ this.ααparent.$set(val,this,$6,'parent') }\n\tget parent(){ return this.ααparent.$get(this,$6,'parent') }\n\tget ααparent(){ return this[$7] || imba_accessor(($17 = this.αref(Scrim),$17),this,$6,'parent',$7,Clip.prototype) }\n\tset offset(val){ this.ααoffset.$set(val,this,$8,'offset') }\n\tget offset(){ return this.ααoffset.$get(this,$8,'offset') }\n\tget ααoffset(){ return this[$9] || imba_accessor(($18 = this.αnumber(),$18),this,$8,'offset',$9,Clip.prototype) }\n\tset num(val){ this.ααnum.$set(val,this,$10,'num') }\n\tget num(){ return this.ααnum.$get(this,$10,'num') }\n\tget ααnum(){ return this[$11] || imba_accessor(($19 = this.αnumber(),$19),this,$10,'num',$11,Clip.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $12;defineName$__(this,'Clip');inheritClass$__(this);}\n};\n\nawait setup(__filename,{data: {\n\ts01: {name: \"Scrim\"},\n\tclip0_s01_1: {parent: 's01',offset: 1,num: 1},\n\tclip0_s01_200: {parent: 's01',offset: 200,num: 1}\n}});\n\n// Unclear how much we are going to use this feature\n\n// Should soon work on client as well??\ntest(\"from\",function({s01: s01,sindre: sindre}) {\n\t\n\tlet clip = Clip.from(s01,1);\n\tok(clip.parent,s01);\n\tok(clip.id,'clip0_s01_1');\n\treturn ok(clip,Clip.get('clip0_s01_1'));\n});\n\ntest(\"get\",async function({s01: s01}) {\n\t\n\tlet clip = Clip.get('clip0_s01_2');\n\tok(clip instanceof Clip);\n\tok(clip.parent,s01);\n\tawait clip;\n\treturn ok(!(clip.existsΦ));\n});\n\ntest(\"basics\",async function({s01: s01,sindre: sindre}) {\n\t\n\tlet clip = await OP.get('clip0_s01_200');\n\tok(clip.parent,s01);\n\treturn ok(clip.offset,200);\n});\n\ntest.todo(\"composite fields are read-only\");\n\ntest(\"non-existant\",async function({s01: s01,sindre: sindre}) {\n\t\n\tlet clip = await OP.get('clip0_s01_201');\n\tok(clip.parent,s01);\n\tok(clip.offset,201);\n\tlet raw = clip.dehydrateΞfor(sindre);\n\treturn ok(clip.offset,201);\n});\n\ntest(\"OPObject.from\",function({s01: s01}) {\n\t\n\tlet clip = Clip.from(s01,400);\n\tok(clip instanceof Clip);\n\treturn ok(clip.id,`clip0_s01_400`);\n});\n","dependencies":[],"map":{"version":3,"file":"composites.test.js","sourceRoot":"","sources":["/Users/sindre/repos/scrimba/op/test/core/composites.test.imba"],"sourcesContent":["import setup from '../setup'\n\nclass Scrim < OPObject\n\tstatic alias = 's'\n\tname @string\n\n# If no object inherits from this we should not even include\n# parent and offset as fields in postgrs?\nclass Clip < OPObject\n\tid @key(@@parent,@@offset)\n\tparent @ref(Scrim)\n\toffset @number\n\tnum @number\n\nawait setup(__filename, data: {\n\ts01: {name: \"Scrim\"}\n\tclip0_s01_1: {parent: 's01', offset:1,num: 1}\n\tclip0_s01_200: {parent: 's01', offset:200,num: 1}\n})\n\n# Unclear how much we are going to use this feature\n\n# Should soon work on client as well??\ntest \"from\" do({s01,sindre})\n\tlet clip = Clip.from(s01,1)\n\tok clip.parent,s01\n\tok clip.id,'clip0_s01_1'\n\tok clip,Clip.get('clip0_s01_1')\n\ntest \"get\" do({s01})\n\tlet clip = Clip.get('clip0_s01_2')\n\tok clip isa Clip\n\tok clip.parent,s01\n\tawait clip\n\tok !clip.exists?\n\ntest \"basics\" do({s01,sindre})\n\tlet clip = await OP.get('clip0_s01_200')\n\tok clip.parent,s01\n\tok clip.offset,200\n\ntest.todo \"composite fields are read-only\"\n\ntest \"non-existant\" do({s01,sindre})\n\tlet clip = await OP.get('clip0_s01_201')\n\tok clip.parent,s01\n\tok clip.offset,201\n\tlet raw = clip.dehydrate-for(sindre)\n\tok clip.offset,201\n\ntest \"OPObject.from\" do({s01})\n\tlet clip = Clip.from(s01,400)\n\tok clip isa Clip\n\tok clip.id,`clip0_s01_400`"],"names":[],"mappings":"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"}},"css":{"code":""},"warnings":[],"errors":[]}
{"js":{"code":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};;\nfunction inheritClass$__(cls){\n\tObject.getPrototypeOf(cls.prototype).constructor?.inherited?.(cls);\n};\nimport {accessor as imba_accessor} from 'imba';\nvar $1 = Symbol('id'), $2 = Symbol(), $3 = Symbol('owner'), $4 = Symbol(), $5 = Symbol('creator'), $6 = Symbol(), $7 = Symbol(), $9, $10, $11;\nconst $__init__$ = Symbol.for('#__init__'), $__patch__$ = Symbol.for('#__patch__'), $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport setup from '../setup';\n\nclass User extends OP.User {\nstatic {\n\tdefineName$__(this,'User');inheritClass$__(this);}};\n\nclass Item extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $8;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($8 = $$.id) !== undefined && this.ααid.$init($8,this,$1,'id',$$);\n\t\tfields && ($8 = $$.owner) !== undefined && this.ααowner.$init($8,this,$3,'owner',$$);\n\t\tfields && ($8 = $$.creator) !== undefined && this.ααcreator.$init($8,this,$5,'creator',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$7 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααid.$init($$ ? $$.id : undefined,this,$1,'id',$$);\n\t\tfields && this.ααowner.$init($$ ? $$.owner : undefined,this,$3,'owner',$$);\n\t\tfields && this.ααcreator.$init($$ ? $$.creator : undefined,this,$5,'creator',$$);\n\t\t\n\t}\n\tset id(val){ this.ααid.$set(val,this,$1,'id') }\n\tget id(){ return this.ααid.$get(this,$1,'id') }\n\tget ααid(){ return this[$2] || imba_accessor(($9 = this.αkey(),($9.r instanceof Function) ? $9.r(OP.OWNER) : ($9.r = OP.OWNER),($9.w instanceof Function) ? $9.w(OP.CREATOR) : ($9.w = OP.CREATOR),$9),this,$1,'id',$2,Item.prototype) }\n\tset owner(val){ this.ααowner.$set(val,this,$3,'owner') }\n\tget owner(){ return this.ααowner.$get(this,$3,'owner') }\n\tget ααowner(){ return this[$4] || imba_accessor(($10 = this.αref(User),($10.as instanceof Function) ? $10.as(OP.OWNER) : ($10.as = OP.OWNER),$10),this,$3,'owner',$4,Item.prototype) }\n\tset creator(val){ this.ααcreator.$set(val,this,$5,'creator') }\n\tget creator(){ return this.ααcreator.$get(this,$5,'creator') }\n\tget ααcreator(){ return this[$6] || imba_accessor(($11 = this.αref(User),($11.as instanceof Function) ? $11.as(OP.OWNER) : ($11.as = OP.OWNER),$11),this,$5,'creator',$6,Item.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $7;defineName$__(this,'Item');inheritClass$__(this);}\n};\n\nawait setup(__filename,{\n\tdata: [\n\t\t{id: 'user01'},\n\t\t{id: 'user02'},\n\t\t{id: 'item01',owner: 'user01'},\n\t\t{id: 'item02',owner: 'user02'}\n\t]\n});\n\nlet u1 = await OP.get('user01');\nlet u2 = await OP.get('user02');\nlet i1 = await OP.get('item01');\nlet i2 = await OP.get('item02');\n\ntest(\"private model roles-for\",function() {\n\t\n\tok(i1.rolesΞfor(u1),+OP.OWNER);\n\tok(i1.rolesΞfor(u2),0);\n\tok(i2.rolesΞfor(u1),0);\n\treturn ok(i2.rolesΞfor(u2),+OP.OWNER);\n});\n\ntest(\"private model readable-for\",function() {\n\t\n\tok(i1.readableΞfor(u1));\n\tnok(i1.readableΞfor(u2));\n\tnok(i2.readableΞfor(u1));\n\treturn ok(i2.readableΞfor(u2));\n});\n\ntest(\"private model readable-for\",function() {\n\t\n\tok(i1.readableΞfor(u1));\n\tnok(i1.readableΞfor(u2));\n\tnok(i2.readableΞfor(u1));\n\treturn ok(i2.readableΞfor(u2));\n});\n","dependencies":[],"map":{"version":3,"file":"privacy.test.js","sourceRoot":"","sources":["/Users/sindre/repos/scrimba/op/test/misc/privacy.test.imba"],"sourcesContent":["import setup from '../setup'\n\nclass User < OP.User\n\nclass Item < OP.Object\n\tid @key.r(OP.OWNER).w(OP.CREATOR)\n\towner @ref(User).as(OP.OWNER)\n\tcreator @ref(User).as(OP.OWNER)\n\nawait setup __filename, {\n\tdata: [\n\t\t{id: 'user01'}\n\t\t{id: 'user02'}\n\t\t{id: 'item01', owner: 'user01'}\n\t\t{id: 'item02', owner: 'user02'}\n\t]\n}\n\nlet u1 = await OP.get 'user01'\nlet u2 = await OP.get 'user02'\nlet i1 = await OP.get 'item01'\nlet i2 = await OP.get 'item02'\n\ntest \"private model roles-for\" do\n\tok i1.roles-for(u1), +OP.OWNER\n\tok i1.roles-for(u2), 0\n\tok i2.roles-for(u1), 0\n\tok i2.roles-for(u2), +OP.OWNER\n\ntest \"private model readable-for\" do\n\tok i1.readable-for(u1)\n\tnok i1.readable-for(u2)\n\tnok i2.readable-for(u1)\n\tok i2.readable-for(u2)\n\ntest \"private model readable-for\" do\n\tok i1.readable-for(u1)\n\tnok i1.readable-for(u2)\n\tnok i2.readable-for(u1)\n\tok i2.readable-for(u2)\n"],"names":[],"mappings":"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"}},"css":{"code":""},"warnings":[],"errors":[]}
{"js":{"code":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};;\nfunction inheritClass$__(cls){\n\tObject.getPrototypeOf(cls.prototype).constructor?.inherited?.(cls);\n};\nimport {accessor as imba_accessor} from 'imba';\nvar $1 = Symbol('name'), $2 = Symbol(), $3 = Symbol(), $5;\nconst $__init__$ = Symbol.for('#__init__'), $__patch__$ = Symbol.for('#__patch__'), $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport setup from '../setup';\n\nclass Item extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $4;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($4 = $$.name) !== undefined && this.ααname.$init($4,this,$1,'name',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$3 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααname.$init($$ ? $$.name : undefined,this,$1,'name',$$);\n\t\t\n\t}\n\tset name(val){ this.ααname.$set(val,this,$1,'name') }\n\tget name(){ return this.ααname.$get(this,$1,'name') }\n\tget ααname(){ return this[$2] || imba_accessor(($5 = this.αstring(),$5),this,$1,'name',$2,Item.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $3;defineName$__(this,'Item');inheritClass$__(this);}\n};\n\nawait setup(__filename);\n\ntest(\"resolved?\",async function() {\n\t\n\tok(Item.all().length,0);\n\tlet item;\n\t\n\titem = Item.build();\n\tok(item.resolvedΦ);\n\tok(item.rev,1);\n\tawait item;\n\tok(item.resolvedΦ);\n\tok(item.rev,1);\n\t\n\titem = Item.new();\n\tok(item.resolvedΦ);\n\tok(item.rev,0);\n\tawait item;\n\tok(item.resolvedΦ);\n\tok(item.rev,0);\n\t\n\t// TODO Should not need to await create?\n\titem = await Item.create();\n\t// nok item.resolved?\n\t// ok item.rev, 1\n\t// await item\n\tok(item.resolvedΦ);\n\tok(item.rev >= 4);\n\t\n\titem = OP.get('item01');\n\tnok(item.resolvedΦ);\n\tok(item.rev,undefined);\n\tawait item;\n\tok(item.resolvedΦ);\n\treturn ok(item.rev <= -1);\n});\n\ntest(\"persisted?\",async function() {\n\t\n\t\n\t// INFO using ok instead of ok here to test against null\n\tlet item = Item.build();\n\tok(item.rev,1);\n\tok(item.persistedΦ,false);\n\t\n\tawait item;\n\tok(item.rev,1);\n\tok(item.persistedΦ,false);\n\t\n\titem.save();\n\tok(item.rev,1);\n\tok(item.persistedΦ,false);\n\t\n\t// if we are in a save - should we not\n\t// wait for it now? makes sense?\n\tawait item;\n\tok(item.rev >= 4);\n\tok(item.persistedΦ,true);\n\t\n\titem = await Item.create();\n\t// ok item.rev, 1\n\t// ok item.persisted?, no\n\t// await item\n\tok(item.rev >= 4);\n\tok(item.persistedΦ,true);\n\t\n\titem = OP.get('item02');\n\tok(item.persistedΦ,null);\n\tok(item.rev,undefined);\n\t\n\tawait item;\n\tok(item.persistedΦ,false);\n\treturn ok(item.rev <= -1);\n});\n\ntest(\"orphan?\",async function() {\n\t\n\tlet item;\n\t\n\titem = Item.build();\n\tok(item.rev,1);\n\tnok(item.orphanΦ);\n\tawait item;\n\tok(item.rev,1);\n\tnok(item.orphanΦ);\n\t\n\titem = Item.build({_rev: 0});\n\tok(item.rev,0);\n\tok(item.orphanΦ);\n\tawait item;\n\tok(item.rev,0);\n\tok(item.orphanΦ);\n\t\n\titem = Item.create();\n\tok(item.rev,1);\n\tnok(item.orphanΦ);\n\tawait item;\n\tnok(item.orphanΦ);\n\tok(item.rev >= 4);\n\treturn nok(item.orphanΦ);\n});\n\ntest(\"saved? & unsaved?\",async function() {\n\t\n\tlet item;\n\t\n\titem = Item.build();\n\tok(item.unsavedΦ);\n\t\n\tawait item;\n\tok(item.unsavedΦ);\n\t\n\titem.save();\n\t// TODO discuss behaviour\n\tok(item.savingΦ);\n\tok(item.unsavedΦ);\n\t\n\tawait item;\n\tok(item.savedΦ);\n\t\n\titem = Item.create();\n\tok(item.unsavedΦ);\n\t\n\tawait item;\n\tok(item.savedΦ);\n\t\n\titem = await Item.create();\n\tok(item.savedΦ);\n\t\n\titem.name = \"one\";\n\tok(item.unsavedΦ);\n\t\n\tawait item;\n\tok(item.unsavedΦ);\n\t\n\titem.save();\n\t// TODO discuss behaviour\n\t// ok item.unsaved?\n\t\n\tawait item;\n\treturn ok(item.savedΦ);\n});\n\ntest(\".set, exists?\",async function() {\n\t\n\tlet item = await Item.create();\n\tok(item.existsΦ);\n\titem = Item.get(Item.key.generate());// random id\n\tawait item;\n\tok(item.resolvedΦ);\n\t// nok item.exists?\n\t\n\tawait item.set({name: 'a'}).save();\n\tok(item.resolvedΦ);\n\treturn ok(item.existsΦ);\n});\n\n// saving? not implemented yet\ntest.todo(\"saving?\");\n","dependencies":[],"map":{"version":3,"file":"predicates.test.js","sourceRoot":"","sources":["/Users/sindre/repos/scrimba/op/test/misc/predicates.test.imba"],"sourcesContent":["import setup from '../setup'\n\nclass Item < OP.Object\n\tname @string\n\nawait setup(__filename)\n\ntest \"resolved?\" do\n\tok Item.all!.length, 0\n\tlet item\n\n\titem = Item.build!\n\tok item.resolved?\n\tok item.rev, 1\n\tawait item\n\tok item.resolved?\n\tok item.rev, 1\n\n\titem = Item.new!\n\tok item.resolved?\n\tok item.rev, 0\n\tawait item\n\tok item.resolved?\n\tok item.rev, 0\n\n\t# TODO Should not need to await create?\n\titem = await Item.create!\n\t# nok item.resolved?\n\t# ok item.rev, 1\n\t# await item\n\tok item.resolved?\n\tok item.rev >= 4\n\n\titem = OP.get 'item01'\n\tnok item.resolved?\n\tok item.rev, undefined\n\tawait item\n\tok item.resolved?\n\tok item.rev <= -1\n\ntest \"persisted?\" do\n\n\t# INFO using ok instead of ok here to test against null\n\tlet item = Item.build!\n\tok item.rev, 1\n\tok item.persisted?, no\n\n\tawait item\n\tok item.rev, 1\n\tok item.persisted?, no\n\n\titem.save!\n\tok item.rev, 1\n\tok item.persisted?, no\n\n\t# if we are in a save - should we not\n\t# wait for it now? makes sense?\n\tawait item\n\tok item.rev >= 4\n\tok item.persisted?, yes\n\n\titem = await Item.create!\n\t# ok item.rev, 1\n\t# ok item.persisted?, no\n\t# await item\n\tok item.rev >= 4\n\tok item.persisted?, yes\n\n\titem = OP.get 'item02'\n\tok item.persisted?, null\n\tok item.rev, undefined\n\n\tawait item\n\tok item.persisted?, no\n\tok item.rev <= -1\n\ntest \"orphan?\" do\n\tlet item\n\n\titem = Item.build!\n\tok item.rev, 1\n\tnok item.orphan?\n\tawait item\n\tok item.rev, 1\n\tnok item.orphan?\n\n\titem = Item.build { _rev:0 }\n\tok item.rev, 0\n\tok item.orphan?\n\tawait item\n\tok item.rev, 0\n\tok item.orphan?\n\n\titem = Item.create!\n\tok item.rev, 1\n\tnok item.orphan?\n\tawait item\n\tnok item.orphan?\n\tok item.rev >= 4\n\tnok item.orphan?\n\ntest \"saved? & unsaved?\" do\n\tlet item\n\n\titem = Item.build!\n\tok item.unsaved?\n\n\tawait item\n\tok item.unsaved?\n\n\titem.save!\n\t# TODO discuss behaviour\n\tok item.saving?\n\tok item.unsaved?\n\n\tawait item\n\tok item.saved?\n\n\titem = Item.create!\n\tok item.unsaved?\n\n\tawait item\n\tok item.saved?\n\n\titem = await Item.create!\n\tok item.saved?\n\n\titem.name = \"one\"\n\tok item.unsaved?\n\n\tawait item\n\tok item.unsaved?\n\n\titem.save!\n\t# TODO discuss behaviour\n\t# ok item.unsaved?\n\n\tawait item\n\tok item.saved?\n\ntest \".set, exists?\" do\n\tlet item = await Item.create!\n\tok item.exists?\n\titem = Item.get(Item.key.generate!) # random id\n\tawait item\n\tok item.resolved?\n\t# nok item.exists?\n\n\tawait item.set(name:'a').save!\n\tok item.resolved?\n\tok item.exists?\n\n# saving? not implemented yet\ntest.todo \"saving?\""],"names":[],"mappings":"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"}},"css":{"code":""},"warnings":[],"errors":[]}
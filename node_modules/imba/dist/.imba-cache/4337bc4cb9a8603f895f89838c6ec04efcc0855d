{"js":{"code":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};;\nfunction inheritClass$__(cls){\n\tObject.getPrototypeOf(cls.prototype).constructor?.inherited?.(cls);\n};\nimport {accessor as imba_accessor} from 'imba';\nvar $1 = Symbol('owner'), $2 = Symbol(), $3 = Symbol(), $5;\nconst $__init__$ = Symbol.for('#__init__'), $__patch__$ = Symbol.for('#__patch__'), $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport {expect} from 'vitest';\n\nimport setup from './setup';\n\nclass Item extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $4;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($4 = $$.owner) !== undefined && this.ααowner.$init($4,this,$1,'owner',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$3 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααowner.$init($$ ? $$.owner : undefined,this,$1,'owner',$$);\n\t\t\n\t}\n\tset owner(val){ this.ααowner.$set(val,this,$1,'owner') }\n\tget owner(){ return this.ααowner.$get(this,$1,'owner') }\n\tget ααowner(){ return this[$2] || imba_accessor(($5 = this.αref(OP.User),($5.foreign instanceof Function) ? $5.foreign() : ($5.foreign = true),$5),this,$1,'owner',$2,Item.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $3;defineName$__(this,'Item');inheritClass$__(this);}\n};\n\nawait setup(__filename);\n\ntest(\"basic\",async function() {\n\t\n\t// Random user that does not exist\n\tlet user = OP.User.get(1234);\n\tlet item = await Item.create();\n\tok(item.persistedΦ);\n\t\n\titem.owner = user;\n\t\n\t// expect(item.save!).toThrowError()\n\tawait expect(item.save()).rejects.toThrow(OPForeignKeyError);\n\treturn ok(item.unsavedΦ);\n});\n","dependencies":[],"map":{"version":3,"file":"errors.test.js","sourceRoot":"","sources":["/Users/sindre/repos/scrimba/op/test/errors.test.imba"],"sourcesContent":["import {expect} from 'vitest'\n\nimport setup from './setup'\n\nclass Item < OP.Object\n\towner @ref(OP.User).foreign\n\nawait setup(__filename)\n\ntest \"basic\" do\n\t# Random user that does not exist\n\tlet user = OP.User.get(1234)\n\tlet item = await Item.create()\n\tok item.persisted?\n\n\titem.owner = user\n\n\t# expect(item.save!).toThrowError()\n\tawait expect(item.save!).rejects.toThrow(OPForeignKeyError)\n\tok item.unsaved?\n"],"names":[],"mappings":";;;;;;;;;;;AAAA,MAAM,EAAE,MAAM,OAAO,QAAQ;;AAE7B,MAAM,CAAC,KAAK,MAAM,SAAS;;AAE3B,KAAK,CAAC,IAAI,SAAG,EAAE,CAAC,MAAM,EAAA;qCAJtB;;;qBAKC,KAAK,CAAA;;EALN;cAAA;;;EAAA;kDAAA;;uCAKC,KAAK;;EALN;KAKC,KAAK;KAAL,KAAK;KAAL,OAAK,gDAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,KAAC,OAAO,2BAAP,OAAO,EAAA,OAAP,OAAO,gCADtB,IAAI;;;AACkB,CAAA;;MAEtB,KAAK,CAAC,UAAU,CAAC;;AAEvB,IAAI,CAAC,OAAO,CAAC,cAAE,GAAA;;;KAEV,IAAI,GAAG,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;KACxB,IAAI,SAAS,IAAI,CAAC,MAAM,EAAE;CAC9B,EAAE,CAAC,IAAI,CAAC,UAAU,CAAA;;CAElB,IAAI,CAAC,KAAK,GAAG,IAAI;;;OAGX,MAAM,CAAC,IAAI,CAAC,IAAI,EAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC;CAC3D,OAAA,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAA;CAAA,CAVb;AAWJ;"}},"css":{"code":""},"warnings":[],"errors":[]}
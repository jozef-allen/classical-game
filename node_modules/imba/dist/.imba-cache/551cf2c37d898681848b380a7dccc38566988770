{"js":{"code":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};;\nfunction inheritClass$__(cls){\n\tObject.getPrototypeOf(cls.prototype).constructor?.inherited?.(cls);\n};\nimport {accessor as imba_accessor} from 'imba';\nvar $1 = Symbol('id'), $2 = Symbol(), $3 = Symbol('creator'), $4 = Symbol(), $5 = Symbol('members'), $6 = Symbol(), $7 = Symbol('name'), $8 = Symbol(), $9 = Symbol('items'), $10 = Symbol(), $11 = Symbol('parents'), $12 = Symbol(), $13 = Symbol('project'), $14 = Symbol(), $15 = Symbol(), $16 = Symbol('todos'), $17 = Symbol(), $18 = Symbol('todos'), $19 = Symbol(), $20 = Symbol('owners'), $21 = Symbol(), $22 = Symbol('name'), $23 = Symbol(), $24 = Symbol('seen'), $25 = Symbol(), $27, $28, $29, $30, $31, $32, $33, $35, $37, $39, $40, $41;\nconst $__init__$ = Symbol.for('#__init__'), $__patch__$ = Symbol.for('#__patch__'), $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport setup from '../setup';\n\nexport class Item extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $26;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($26 = $$.id) !== undefined && this.ααid.$init($26,this,$1,'id',$$);\n\t\tfields && ($26 = $$.creator) !== undefined && this.ααcreator.$init($26,this,$3,'creator',$$);\n\t\tfields && ($26 = $$.members) !== undefined && this.ααmembers.$init($26,this,$5,'members',$$);\n\t\tfields && ($26 = $$.name) !== undefined && this.ααname.$init($26,this,$7,'name',$$);\n\t\tfields && ($26 = $$.items) !== undefined && this.ααitems.$init($26,this,$9,'items',$$);\n\t\tfields && ($26 = $$.parents) !== undefined && this.ααparents.$init($26,this,$11,'parents',$$);\n\t\tfields && ($26 = $$.project) !== undefined && this.ααproject.$init($26,this,$13,'project',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$15 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααid.$init($$ ? $$.id : undefined,this,$1,'id',$$);\n\t\tfields && this.ααcreator.$init($$ ? $$.creator : undefined,this,$3,'creator',$$);\n\t\tfields && this.ααmembers.$init($$ ? $$.members : undefined,this,$5,'members',$$);\n\t\tfields && this.ααname.$init($$ ? $$.name : undefined,this,$7,'name',$$);\n\t\tfields && this.ααitems.$init($$ ? $$.items : undefined,this,$9,'items',$$);\n\t\tfields && this.ααparents.$init($$ ? $$.parents : undefined,this,$11,'parents',$$);\n\t\tfields && this.ααproject.$init($$ ? $$.project : undefined,this,$13,'project',$$);\n\t\t\n\t}\n\tset id(val){ this.ααid.$set(val,this,$1,'id') }\n\tget id(){ return this.ααid.$get(this,$1,'id') }\n\tget ααid(){ return this[$2] || imba_accessor(($27 = this.αkey(),$27),this,$1,'id',$2,Item.prototype) }\n\tset creator(val){ this.ααcreator.$set(val,this,$3,'creator') }\n\tget creator(){ return this.ααcreator.$get(this,$3,'creator') }\n\tget ααcreator(){ return this[$4] || imba_accessor(($28 = this.αref(OP.User),($28.as instanceof Function) ? $28.as(OP.OWNER) : ($28.as = OP.OWNER),$28.default = function() {\n\t\treturn OP.user;\n\t},$28),this,$3,'creator',$4,Item.prototype) }\n\tset members(val){ this.ααmembers.$set(val,this,$5,'members') }\n\tget members(){ return this.ααmembers.$get(this,$5,'members') }\n\tget ααmembers(){ return this[$6] || imba_accessor(($29 = this.αitems(OP.User),($29.as instanceof Function) ? $29.as(OP.MEMBER) : ($29.as = OP.MEMBER),$29),this,$5,'members',$6,Item.prototype) }\n\t\n\tset name(val){ this.ααname.$set(val,this,$7,'name') }\n\tget name(){ return this.ααname.$get(this,$7,'name') }\n\tget ααname(){ return this[$8] || imba_accessor(($30 = this.αstring(),$30),this,$7,'name',$8,Item.prototype) }\n\tset items(val){ this.ααitems.$set(val,this,$9,'items') }\n\tget items(){ return this.ααitems.$get(this,$9,'items') }\n\tget ααitems(){ return this[$10] || imba_accessor(($31 = this.αchildren(Item),$31),this,$9,'items',$10,Item.prototype) }\n\tset parents(val){ this.ααparents.$set(val,this,$11,'parents') }\n\tget parents(){ return this.ααparents.$get(this,$11,'parents') }\n\tget ααparents(){ return this[$12] || imba_accessor(($32 = this.αparents(List),$32),this,$11,'parents',$12,Item.prototype) }\n\tset project(val){ this.ααproject.$set(val,this,$13,'project') }\n\tget project(){ return this.ααproject.$get(this,$13,'project') }\n\tget ααproject(){ return this[$14] || imba_accessor(($33 = this.αparent(Project),$33),this,$13,'project',$14,Item.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $15;defineName$__(this,'Item');inheritClass$__(this);}\n};\n\nexport class Project extends Item {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $34;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($34 = $$.todos) !== undefined && this.ααtodos.$init($34,this,$16,'todos',$$);\n\t\t\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααtodos.$init($$ ? $$.todos : undefined,this,$16,'todos',$$);\n\t\t\n\t}\n\tset todos(val){ this.ααtodos.$set(val,this,$16,'todos') }\n\tget todos(){ return this.ααtodos.$get(this,$16,'todos') }\n\tget ααtodos(){ return this[$17] || imba_accessor(($35 = this.αchildren(Todo),$35),this,$16,'todos',$17,Project.prototype) }\n\tstatic {\n\t\tdefineName$__(this,'Project');this.alias = 'p';\n\t\tinheritClass$__(this);}\n};\n\nexport class List extends Item {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $36;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($36 = $$.todos) !== undefined && this.ααtodos.$init($36,this,$18,'todos',$$);\n\t\t\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααtodos.$init($$ ? $$.todos : undefined,this,$18,'todos',$$);\n\t\t\n\t}\n\tset todos(val){ this.ααtodos.$set(val,this,$18,'todos') }\n\tget todos(){ return this.ααtodos.$get(this,$18,'todos') }\n\tget ααtodos(){ return this[$19] || imba_accessor(($37 = this.αchildren(Todo),$37),this,$18,'todos',$19,List.prototype) }\n\tstatic {\n\t\tdefineName$__(this,'List');this.alias = 'l';\n\t\tinheritClass$__(this);}\n};\n\nexport class Todo extends Item {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $38;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($38 = $$.owners) !== undefined && this.ααowners.$init($38,this,$20,'owners',$$);\n\t\tfields && ($38 = $$.name) !== undefined && this.ααname.$init($38,this,$22,'name',$$);\n\t\tfields && ($38 = $$.seen) !== undefined && this.ααseen.$init($38,this,$24,'seen',$$);\n\t\t\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααowners.$init($$ ? $$.owners : undefined,this,$20,'owners',$$);\n\t\tfields && this.ααname.$init($$ ? $$.name : undefined,this,$22,'name',$$);\n\t\tfields && this.ααseen.$init($$ ? $$.seen : undefined,this,$24,'seen',$$);\n\t\t\n\t}\n\tset owners(val){ this.ααowners.$set(val,this,$20,'owners') }\n\tget owners(){ return this.ααowners.$get(this,$20,'owners') }\n\tget ααowners(){ return this[$21] || imba_accessor(($39 = this.αitems(OP.User),$39),this,$20,'owners',$21,Todo.prototype) }\n\tset name(val){ this.ααname.$set(val,this,$22,'name') }\n\tget name(){ return this.ααname.$get(this,$22,'name') }\n\tget ααname(){ return this[$23] || imba_accessor(($40 = this.αstring(),$40),this,$22,'name',$23,Todo.prototype) }\n\tset seen(val){ this.ααseen.$set(val,this,$24,'seen') }\n\tget seen(){ return this.ααseen.$get(this,$24,'seen') }\n\tget ααseen(){ return this[$25] || imba_accessor(($41 = this.αnumber(),($41.pov instanceof Function) ? $41.pov() : ($41.pov = true),$41),this,$24,'seen',$25,Todo.prototype) }\n\tstatic {\n\t\tdefineName$__(this,'Todo');this.alias = 't';\n\t\tinheritClass$__(this);}\n};\n\nawait setup(__filename,{data: {\n\tU01: {name: 'Sindre'},\n\tU02: {name: 'Mikey'},\n\tp01: {name: 'Project',creator: 'U01'},\n\tp02: {name: 'Project',creator: 'U01',members: ['U02']},\n\tp03: {name: 'Project',creator: 'U02',members: ['U01']}\n}});\n\n// load everything\nawait Item.fetchΞall();\n\ntest(\"initial\",function({U01: U01,U02: U02}) {\n\t\n\tok(Project.size,3);\n\tok(OP.User.size,2);\n\treturn ok(U01.$affiliations.size,3);\n});\n","dependencies":[],"map":{"version":3,"file":"affiliations.test.js","sourceRoot":"","sources":["/Users/sindre/repos/scrimba/op/test/affiliations.test.imba"],"sourcesContent":["import setup from '../setup'\n\nexport class Item < OP.Object\n\tid @key\n\tcreator @ref(OP.User).as(OP.OWNER) = OP.user\n\tmembers @items(OP.User).as(OP.MEMBER)\n\n\tname @string\n\titems @children(Item)\n\tparents @parents(List)\n\tproject @parent(Project)\n\nexport class Project < Item\n\tstatic alias = 'p'\n\ttodos @children(Todo)\n\nexport class List < Item\n\tstatic alias = 'l'\n\ttodos @children(Todo)\n\nexport class Todo < Item\n\tstatic alias = 't'\n\towners @items(OP.User)\n\tname @string\n\tseen @number.pov\n\nawait setup(__filename, data: {\n\tU01: {name: 'Sindre'}\n\tU02: {name: 'Mikey'}\n\tp01: {name: 'Project', creator: 'U01'}\n\tp02: {name: 'Project', creator: 'U01', members: ['U02']}\n\tp03: {name: 'Project', creator: 'U02', members: ['U01']}\n})\n\n# load everything\nawait Item.fetch-all()\n\ntest \"initial\" do({U01,U02})\n\tok Project.size,3\n\tok OP.User.size,2\n\tok U01.$affiliations.size,3\n"],"names":[],"mappings":"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"}},"css":{"code":""},"warnings":[],"errors":[]}
{"js":{"code":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};;\nfunction inheritClass$__(cls){\n\tObject.getPrototypeOf(cls.prototype).constructor?.inherited?.(cls);\n};\nimport {accessor as imba_accessor} from 'imba';\nvar $1 = Symbol('score'), $2 = Symbol(), $3 = Symbol('rank'), $4 = Symbol(), $5 = Symbol(), $6 = Symbol('score'), $7 = Symbol(), $8 = Symbol('rank'), $9 = Symbol(), $10 = Symbol('deep'), $11 = Symbol(), $12 = Symbol(), $13 = Symbol('note'), $14 = Symbol(), $15 = Symbol(), $16 = Symbol('name'), $17 = Symbol(), $18 = Symbol('index'), $19 = Symbol(), $20 = Symbol(), $21 = Symbol('id'), $22 = Symbol(), $23 = Symbol('binary'), $24 = Symbol(), $25 = Symbol('creator'), $26 = Symbol(), $27 = Symbol('members'), $28 = Symbol(), $29 = Symbol('users'), $30 = Symbol(), $31 = Symbol('name'), $32 = Symbol(), $33 = Symbol('desc'), $34 = Symbol(), $35 = Symbol('stats'), $36 = Symbol(), $37 = Symbol('layers'), $38 = Symbol(), $39 = Symbol(), $41, $42, $44, $45, $46, $48, $50, $51, $53, $54, $55, $56, $57, $58, $59, $60, $61;\nconst $__init__$ = Symbol.for('#__init__'), $__patch__$ = Symbol.for('#__patch__'), $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport setup from './setup';\nimport nfs from 'fs';\n\nclass ItemStatsDeep extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $40;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($40 = $$.score) !== undefined && this.ααscore.$init($40,this,$1,'score',$$);\n\t\tfields && ($40 = $$.rank) !== undefined && this.ααrank.$init($40,this,$3,'rank',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$5 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααscore.$init($$ ? $$.score : undefined,this,$1,'score',$$);\n\t\tfields && this.ααrank.$init($$ ? $$.rank : undefined,this,$3,'rank',$$);\n\t\t\n\t}\n\tset score(val){ this.ααscore.$set(val,this,$1,'score') }\n\tget score(){ return this.ααscore.$get(this,$1,'score') }\n\tget ααscore(){ return this[$2] || imba_accessor(($41 = this.αnumber(),$41),this,$1,'score',$2,ItemStatsDeep.prototype) }\n\tset rank(val){ this.ααrank.$set(val,this,$3,'rank') }\n\tget rank(){ return this.ααrank.$get(this,$3,'rank') }\n\tget ααrank(){ return this[$4] || imba_accessor(($42 = this.αnumber(),$42),this,$3,'rank',$4,ItemStatsDeep.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $5;defineName$__(this,'ItemStatsDeep');inheritClass$__(this);}\n};\n\nclass ItemStats extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $43;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($43 = $$.score) !== undefined && this.ααscore.$init($43,this,$6,'score',$$);\n\t\tfields && ($43 = $$.rank) !== undefined && this.ααrank.$init($43,this,$8,'rank',$$);\n\t\tfields && ($43 = $$.deep) !== undefined && this.ααdeep.$init($43,this,$10,'deep',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$12 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααscore.$init($$ ? $$.score : undefined,this,$6,'score',$$);\n\t\tfields && this.ααrank.$init($$ ? $$.rank : undefined,this,$8,'rank',$$);\n\t\tfields && this.ααdeep.$init($$ ? $$.deep : undefined,this,$10,'deep',$$);\n\t\t\n\t}\n\tset score(val){ this.ααscore.$set(val,this,$6,'score') }\n\tget score(){ return this.ααscore.$get(this,$6,'score') }\n\tget ααscore(){ return this[$7] || imba_accessor(($44 = this.αnumber(),$44),this,$6,'score',$7,ItemStats.prototype) }\n\tset rank(val){ this.ααrank.$set(val,this,$8,'rank') }\n\tget rank(){ return this.ααrank.$get(this,$8,'rank') }\n\tget ααrank(){ return this[$9] || imba_accessor(($45 = this.αnumber(),$45),this,$8,'rank',$9,ItemStats.prototype) }\n\tset deep(val){ this.ααdeep.$set(val,this,$10,'deep') }\n\tget deep(){ return this.ααdeep.$get(this,$10,'deep') }\n\tget ααdeep(){ return this[$11] || imba_accessor(($46 = this.αembed(ItemStatsDeep),$46),this,$10,'deep',$11,ItemStats.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $12;defineName$__(this,'ItemStats');inheritClass$__(this);}\n};\n\nclass CustomBinary extends OP.Blob {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $47;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($47 = $$.note) !== undefined && this.ααnote.$init($47,this,$13,'note',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$15 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααnote.$init($$ ? $$.note : undefined,this,$13,'note',$$);\n\t\t\n\t}\n\tset note(val){ this.ααnote.$set(val,this,$13,'note') }\n\tget note(){ return this.ααnote.$get(this,$13,'note') }\n\tget ααnote(){ return this[$14] || imba_accessor(($48 = this.αstring(),$48),this,$13,'note',$14,CustomBinary.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $15;defineName$__(this,'CustomBinary');inheritClass$__(this);}\n};\n\nclass LayerSettings extends OP.Object {\nstatic {\n\tdefineName$__(this,'LayerSettings');inheritClass$__(this);}};\n\n// inherit from OPEmbed for optimized embeddable object - that doesnt create a table\n// and is not setup for other causes\nclass Layer extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $49;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($49 = $$.name) !== undefined && this.ααname.$init($49,this,$16,'name',$$);\n\t\tfields && ($49 = $$.index) !== undefined && this.ααindex.$init($49,this,$18,'index',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$20 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααname.$init($$ ? $$.name : undefined,this,$16,'name',$$);\n\t\tfields && this.ααindex.$init($$ ? $$.index : undefined,this,$18,'index',$$);\n\t\t\n\t}\n\tset name(val){ this.ααname.$set(val,this,$16,'name') }\n\tget name(){ return this.ααname.$get(this,$16,'name') }\n\tget ααname(){ return this[$17] || imba_accessor(($50 = this.αstring(),$50),this,$16,'name',$17,Layer.prototype) }\n\tset index(val){ this.ααindex.$set(val,this,$18,'index') }\n\tget index(){ return this.ααindex.$get(this,$18,'index') }\n\tget ααindex(){ return this[$19] || imba_accessor(($51 = this.αnumber(),$51),this,$18,'index',$19,Layer.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $20;defineName$__(this,'Layer');inheritClass$__(this);}\n};\n\nexport class Item extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $52;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($52 = $$.id) !== undefined && this.ααid.$init($52,this,$21,'id',$$);\n\t\tfields && ($52 = $$.binary) !== undefined && this.ααbinary.$init($52,this,$23,'binary',$$);\n\t\tfields && ($52 = $$.creator) !== undefined && this.ααcreator.$init($52,this,$25,'creator',$$);\n\t\tfields && ($52 = $$.members) !== undefined && this.ααmembers.$init($52,this,$27,'members',$$);\n\t\tfields && ($52 = $$.users) !== undefined && this.ααusers.$init($52,this,$29,'users',$$);\n\t\tfields && ($52 = $$.name) !== undefined && this.ααname.$init($52,this,$31,'name',$$);\n\t\tfields && ($52 = $$.desc) !== undefined && this.ααdesc.$init($52,this,$33,'desc',$$);\n\t\tfields && ($52 = $$.stats) !== undefined && this.ααstats.$init($52,this,$35,'stats',$$);\n\t\tfields && ($52 = $$.layers) !== undefined && this.ααlayers.$init($52,this,$37,'layers',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$39 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααid.$init($$ ? $$.id : undefined,this,$21,'id',$$);\n\t\tfields && this.ααbinary.$init($$ ? $$.binary : undefined,this,$23,'binary',$$);\n\t\tfields && this.ααcreator.$init($$ ? $$.creator : undefined,this,$25,'creator',$$);\n\t\tfields && this.ααmembers.$init($$ ? $$.members : undefined,this,$27,'members',$$);\n\t\tfields && this.ααusers.$init($$ ? $$.users : undefined,this,$29,'users',$$);\n\t\tfields && this.ααname.$init($$ ? $$.name : undefined,this,$31,'name',$$);\n\t\tfields && this.ααdesc.$init($$ ? $$.desc : undefined,this,$33,'desc',$$);\n\t\tfields && this.ααstats.$init($$ ? $$.stats : undefined,this,$35,'stats',$$);\n\t\tfields && this.ααlayers.$init($$ ? $$.layers : undefined,this,$37,'layers',$$);\n\t\t\n\t}\n\tset id(val){ this.ααid.$set(val,this,$21,'id') }\n\tget id(){ return this.ααid.$get(this,$21,'id') }\n\tget ααid(){ return this[$22] || imba_accessor(($53 = this.αkey(),$53),this,$21,'id',$22,Item.prototype) }\n\tset binary(val){ this.ααbinary.$set(val,this,$23,'binary') }\n\tget binary(){ return this.ααbinary.$get(this,$23,'binary') }\n\tget ααbinary(){ return this[$24] || imba_accessor(($54 = this.αembed(CustomBinary),$54),this,$23,'binary',$24,Item.prototype) }\n\tset creator(val){ this.ααcreator.$set(val,this,$25,'creator') }\n\tget creator(){ return this.ααcreator.$get(this,$25,'creator') }\n\tget ααcreator(){ return this[$26] || imba_accessor(($55 = this.αref(OP.User),($55.as instanceof Function) ? $55.as(OP.OWNER) : ($55.as = OP.OWNER),$55.default = function() {\n\t\treturn OP.user;\n\t},$55),this,$25,'creator',$26,Item.prototype) }\n\tset members(val){ this.ααmembers.$set(val,this,$27,'members') }\n\tget members(){ return this.ααmembers.$get(this,$27,'members') }\n\tget ααmembers(){ return this[$28] || imba_accessor(($56 = this.αitems(OP.User),($56.as instanceof Function) ? $56.as(OP.MEMBER) : ($56.as = OP.MEMBER),$56),this,$27,'members',$28,Item.prototype) }\n\tset users(val){ this.ααusers.$set(val,this,$29,'users') }\n\tget users(){ return this.ααusers.$get(this,$29,'users') }\n\tget ααusers(){ return this[$30] || imba_accessor(($57 = this.αzset(OP.User),$57),this,$29,'users',$30,Item.prototype) }\n\tset name(val){ this.ααname.$set(val,this,$31,'name') }\n\tget name(){ return this.ααname.$get(this,$31,'name') }\n\tget ααname(){ return this[$32] || imba_accessor(($58 = this.αstring(),$58),this,$31,'name',$32,Item.prototype) }\n\tset desc(val){ this.ααdesc.$set(val,this,$33,'desc') }\n\tget desc(){ return this.ααdesc.$get(this,$33,'desc') }\n\tget ααdesc(){ return this[$34] || imba_accessor(($59 = this.αstring(),$59),this,$33,'desc',$34,Item.prototype) }\n\tset stats(val){ this.ααstats.$set(val,this,$35,'stats') }\n\tget stats(){ return this.ααstats.$get(this,$35,'stats') }\n\tget ααstats(){ return this[$36] || imba_accessor(($60 = this.αembed(ItemStats),$60),this,$35,'stats',$36,Item.prototype) }\n\tset layers(val){ this.ααlayers.$set(val,this,$37,'layers') }\n\tget layers(){ return this.ααlayers.$get(this,$37,'layers') }\n\tget ααlayers(){ return this[$38] || imba_accessor(($61 = this.αembeds(Layer),$61),this,$37,'layers',$38,Item.prototype) }// multiple embeds\n\t\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $39;defineName$__(this,'Item');inheritClass$__(this);}\n};\n\nawait setup(__filename,{data: {\n\tU01: {name: 'Sindre'},\n\tU02: {name: 'Mikey'},\n\tU03: {name: 'Frode'},\n\tU04: {name: 'Abdellah'},\n\titem01: {name: 'Item',creator: 'U01'},\n\titem02: {name: 'Item',creator: 'U01'},\n\titem03: {name: 'Item',creator: 'U01',stats: {rank: 10,deep: {score: 20}}},\n\t\n\titem04: {name: 'Item',creator: 'U01',layers: {\n\t\tlayer01: {name: \"Layer1\"},\n\t\tlayer02: {name: \"Layer2\"}\n\t}},\n\t\n\titem: function() { return Item.create({name: 'Item',creator: 'U01',layers: {\n\t\tlayer01: {name: \"Layer1\"},\n\t\tlayer02: {name: \"Layer2\"}\n\t}}); }\n}});\n\n// OPEmbed should inherit from OPObject but be specialized for embedding\n// No table should be created for them in postgres etc.\n\ndescribe(\"@embed(Blob)\",function() {\n\t\n\t\n\treturn test(\"embed\",async function({U01: U01}) {\n\t\t\n\t\tlet item = await Item.create({binary: {}});\n\t\tok(item.savedΦ);\n\t\tawait item.binary.append(\"1234\");\n\t\tawait item.binary.append(\"56\");\n\t\titem.binary.note = \"Hello\";\n\t\tawait item.save();\n\t\tlet res = await item.binary.read();\n\t\tok(res instanceof BinaryChunk);\n\t\treturn ok(Buffer.from(res.data).toString('utf8'),\"123456\");\n\t});\n});\n\n// TEST patching data\n\ndescribe(\"@embeds\",function() {\n\t\n\t\n\ttest(\"awakening\",async function({U01: U01,item04: item04}) {\n\t\t\n\t\tlet layer = item04.layers[0];\n\t\tok(item04.layers.size,2);\n\t\tok(layer instanceof Layer);\n\t\tok(layer.$plain.name,\"Layer1\");\n\t\tlayer.name = \"Renamed\";\n\t\tawait item04.save();\n\t\tnull;\n\t\treturn ok(layer.$cloud.name,\"Renamed\");\n\t});\n\t\n\ttest.fails(\"adding wrong type\",function({U01: U01,item03: item03}) {\n\t\t\n\t\treturn item03.layers.add(U01);\n\t});\n\t\n\ttest(\"embeds.create\",async function({U01: U01,item03: item03}) {\n\t\t\n\t\tlet item = /**@type {Item}*/(item03);\n\t\tlet layers = item.layers;\n\t\tlet res = await item.layers.create({name: \"Hello\"});\n\t\t\n\t\tok(res instanceof Layer);\n\t\t\n\t\t// This item should not exist in rich object map\n\t\t// ok !OP.$rich[res.id]\n\t\tawait item.save();\n\t\treturn ok(item03.layers.size,1);\n\t});\n\t\n\ttest(\"creation\",function({item: item}) {\n\t\t\n\t\tlet l1 = item.layers.get('layer01');\n\t\treturn ok(l1.$cloud,l1.$plain);\n\t});\n\t\n\ttest(\"only save created embeds\",async function() {\n\t\t\n\t\tlet item = await Item.build({name: 'Item',creator: 'U01'});\n\t\tok(item.$plain);\n\t\tlet l1 = item.layers.create({name: \"1\"});\n\t\tlet l2 = item.layers.build({name: \"2\"});\n\t\tawait item.save();\n\t\tok(item.persistedΦ);\n\t\tok(l1.persistedΦ);\n\t\treturn ok(!(l2.persistedΦ));\n\t});\n\t\n\ttest(\"embeds.add\",async function({U01: U01,item: item}) {\n\t\t\n\t\tlet layer = new Layer({name: \"Layer3\"});\n\t\titem.layers.add(layer);\n\t\tawait item.save();\n\t\tok(!(OP.$rich[layer.id]));\n\t\titem.layers.add({name: \"Layer4\"});\n\t\t// items should not be registered\n\t\tok(Layer.all().size,0);\n\t\treturn await item.save();\n\t});\n\t\n\ttest(\"embeds.add new\",async function({item: item}) {\n\t\t\n\t\tlet layer = new Layer({name: \"Layer3\"});\n\t\titem.layers.add(layer);\n\t\treturn await item.save();\n\t});\n\t\n\ttest(\"clone layers\",async function({item03: item03,item: item}) {\n\t\t\n\t\titem.layers.add(item03.layers[0]);\n\t\tlet l2 = item.layers.add(item03.layers[0]);\n\t\tawait item.save();\n\t\tl2.name = 'l2';\n\t\treturn await item.save();\n\t});\n\t\n\ttest(\"deep patching\",async function({item: item}) {\n\t\t\n\t\tlet layer = item.layers.get('layer01');\n\t\tok(item.persistedΦ);\n\t\tok(layer.name,\"Layer1\");\n\t\t\n\t\tlet upd = await OP.db.update(item.id,{'layers.layer01.name': \"Renamed\"});\n\t\titem.$patch(upd);\n\t\treturn ok(layer.name,\"Renamed\");\n\t});\n\t\n\ttest(\"add patching\",async function({item: item}) {\n\t\t\n\t\tlet upd = await OP.db.update(item.id,{'layers.layer05': {name: \"5\"}});\n\t\titem.$patch(upd);\n\t\tlet l5 = item.layers.layer05;\n\t\tok(l5);\n\t\treturn ok(l5.name,\"5\");\n\t});\n\t\n\ttest(\"saving embedded item\",async function() {\n\t\t\n\t\tlet item = Item.build();\n\t\tok(!(item.persistedΦ));\n\t\tlet l1 = item.layers.add({name: \"1\"});\n\t\t// This should definitely not add anything to the db\n\t\tawait l1.save();\n\t\t// Bug where we actually inserted that item\n\t\tnok(await OP.one`select * from _item where id = ${l1.id}`);\n\t\tok(!(l1.persistedΦ));\n\t\treturn await item.save();\n\t});\n\t\n\ttest(\"saving\",async function() {\n\t\t\n\t\tlet item = Item.build();\n\t\tok(!(item.persistedΦ));\n\t\tlet l1 = item.layers.add({name: \"1\"});\n\t\tok(!(l1.persistedΦ));\n\t\tok(l1.embedΦ);\n\t\tl1.name = \"11\";\n\t\tok(!(l1.persistedΦ));\n\t\tawait item.save();\n\t\tok(item.persistedΦ);\n\t\treturn ok(l1.persistedΦ);\n\t});\n\t\n\ttest(\"deleted\",async function() {\n\t\t\n\t\tlet item = await Item.create({name: 'Item',creator: 'U01',layers: {\n\t\t\tlayer01: {name: \"Layer1\"},\n\t\t\tlayer02: {name: \"Layer2\",_del: 10}\n\t\t}});\n\t\tlet l2 = item.layers.get(\"layer02\");\n\t\tok(l2.deletedΦ);\n\t\tok(!(l2.existsΦ));\n\t\t// Should it actually be hidden from the list of layers?\n\t\treturn ok(item.layers.size,1);\n\t});\n\t\n\treturn test(\"delete layer\",async function({item: item}) {\n\t\t\n\t\tlet l1 = item.layers.get(\"layer01\");\n\t\tok(l1.$cloud,l1.$plain);\n\t\tl1.destroy();\n\t\tawait l1.save();\n\t\tok(l1.deletedΦ);\n\t\treturn ok(!(l1.existsΦ));\n\t});\n});\n","dependencies":[],"map":{"version":3,"file":"embeds.test.js","sourceRoot":"","sources":["/Users/sindre/repos/scrimba/op/test/embeds.test.imba"],"sourcesContent":["import setup from './setup'\nimport nfs from 'fs'\n\nclass ItemStatsDeep < OP.Object\n\tscore @number\n\trank @number\n\nclass ItemStats < OP.Object\n\tscore @number\n\trank @number\n\tdeep @embed(ItemStatsDeep)\n\nclass CustomBinary < OP.Blob\n\tnote @string\n\nclass LayerSettings < OP.Object\n\n# inherit from OPEmbed for optimized embeddable object - that doesnt create a table\n# and is not setup for other causes\nclass Layer < OP.Object\n\tname @string\n\tindex @number\n\nexport class Item < OP.Object\n\tid @key\n\tbinary @embed(CustomBinary)\n\tcreator @ref(OP.User).as(OP.OWNER) = OP.user\n\tmembers @items(OP.User).as(OP.MEMBER)\n\tusers @zset(OP.User)\n\tname @string\n\tdesc @string\n\tstats @embed(ItemStats)\n\tlayers @embeds(Layer) # multiple embeds\n\nawait setup(__filename, data: {\n\tU01: {name: 'Sindre'}\n\tU02: {name: 'Mikey'}\n\tU03: {name: 'Frode'}\n\tU04: {name: 'Abdellah'}\n\titem01: {name: 'Item', creator: 'U01'}\n\titem02: {name: 'Item', creator: 'U01'}\n\titem03: {name: 'Item', creator: 'U01', stats: {rank: 10, deep: {score: 20}}}\n\n\titem04: {name: 'Item', creator: 'U01', layers: {\n\t\tlayer01: {name: \"Layer1\"}\n\t\tlayer02: {name: \"Layer2\"}\n\t}}\n\n\titem: do Item.create {name: 'Item', creator: 'U01', layers: {\n\t\tlayer01: {name: \"Layer1\"}\n\t\tlayer02: {name: \"Layer2\"}\n\t}}\n})\n\n# OPEmbed should inherit from OPObject but be specialized for embedding\n# No table should be created for them in postgres etc.\n\ndescribe \"@embed(Blob)\" do\n\n\ttest \"embed\" do({U01})\n\t\tlet item = await Item.create(binary: {})\n\t\tok item.saved?\n\t\tawait item.binary.append(\"1234\")\n\t\tawait item.binary.append(\"56\")\n\t\titem.binary.note = \"Hello\"\n\t\tawait item.save!\n\t\tlet res = await item.binary.read!\n\t\tok res isa BinaryChunk\n\t\tok Buffer.from(res.data).toString('utf8'),\"123456\"\n\n# TEST patching data\n\ndescribe \"@embeds\" do\n\n\ttest \"awakening\" do({U01,item04})\n\t\tlet layer = item04.layers[0]\n\t\tok item04.layers.size,2\n\t\tok layer isa Layer\n\t\tok layer.$plain.name,\"Layer1\"\n\t\tlayer.name = \"Renamed\"\n\t\tawait item04.save!\n\t\tnull\n\t\tok layer.$cloud.name,\"Renamed\"\n\n\ttest.fails \"adding wrong type\" do({U01,item03})\n\t\titem03.layers.add(U01)\n\n\ttest \"embeds.create\" do({U01,item03})\n\t\tlet item = item03\\Item\n\t\tlet layers = item.layers\n\t\tlet res = await item.layers.create(name: \"Hello\")\n\n\t\tok res isa Layer\n\n\t\t# This item should not exist in rich object map\n\t\t# ok !OP.$rich[res.id]\n\t\tawait item.save!\n\t\tok item03.layers.size,1\n\n\ttest \"creation\" do({item})\n\t\tlet l1 = item.layers.get('layer01')\n\t\tok l1.$cloud,l1.$plain\n\n\ttest \"only save created embeds\" do\n\t\tlet item = await Item.build(name: 'Item', creator: 'U01')\n\t\tok item.$plain\n\t\tlet l1 = item.layers.create(name: \"1\")\n\t\tlet l2 = item.layers.build(name: \"2\")\n\t\tawait item.save!\n\t\tok item.persisted?\n\t\tok l1.persisted?\n\t\tok !l2.persisted?\n\n\ttest \"embeds.add\" do({U01,item})\n\t\tlet layer = new Layer(name: \"Layer3\")\n\t\titem.layers.add(layer)\n\t\tawait item.save!\n\t\tok !OP.$rich[layer.id]\n\t\titem.layers.add(name: \"Layer4\")\n\t\t# items should not be registered\n\t\tok Layer.all!.size, 0\n\t\tawait item.save!\n\n\ttest \"embeds.add new\" do({item})\n\t\tlet layer = new Layer(name: \"Layer3\")\n\t\titem.layers.add(layer)\n\t\tawait item.save!\n\n\ttest \"clone layers\" do({item03,item})\n\t\titem.layers.add(item03.layers[0])\n\t\tlet l2 = item.layers.add(item03.layers[0])\n\t\tawait item.save!\n\t\tl2.name = 'l2'\n\t\tawait item.save!\n\n\ttest \"deep patching\" do({item})\n\t\tlet layer = item.layers.get('layer01')\n\t\tok item.persisted?\n\t\tok layer.name, \"Layer1\"\n\n\t\tlet upd = await OP.db.update(item.id,{'layers.layer01.name': \"Renamed\"})\n\t\titem.$patch(upd)\n\t\tok layer.name,\"Renamed\"\n\n\ttest \"add patching\" do({item})\n\t\tlet upd = await OP.db.update(item.id,{'layers.layer05': {name: \"5\"}})\n\t\titem.$patch(upd)\n\t\tlet l5 = item.layers['layer05']\n\t\tok l5\n\t\tok l5.name,\"5\"\n\n\ttest \"saving embedded item\" do\n\t\tlet item = Item.build()\n\t\tok !item.persisted?\n\t\tlet l1 = item.layers.add(name: \"1\")\n\t\t# This should definitely not add anything to the db\n\t\tawait l1.save!\n\t\t# Bug where we actually inserted that item\n\t\tnok await OP.one`select * from _item where id = {l1.id}`\n\t\tok !l1.persisted?\n\t\tawait item.save!\n\n\ttest \"saving\" do\n\t\tlet item = Item.build()\n\t\tok !item.persisted?\n\t\tlet l1 = item.layers.add(name: \"1\")\n\t\tok !l1.persisted?\n\t\tok l1.embed?\n\t\tl1.name = \"11\"\n\t\tok !l1.persisted?\n\t\tawait item.save!\n\t\tok item.persisted?\n\t\tok l1.persisted?\n\n\ttest \"deleted\" do\n\t\tlet item = await Item.create {name: 'Item', creator: 'U01', layers: {\n\t\t\tlayer01: {name: \"Layer1\"}\n\t\t\tlayer02: {name: \"Layer2\",_del: 10}\n\t\t}}\n\t\tlet l2 = item.layers.get(\"layer02\")\n\t\tok l2.deleted?\n\t\tok !l2.exists?\n\t\t# Should it actually be hidden from the list of layers?\n\t\tok item.layers.size,1\n\n\ttest \"delete layer\" do({item})\n\t\tlet l1 = item.layers.get(\"layer01\")\n\t\tok l1.$cloud,l1.$plain\n\t\tl1.destroy!\n\t\tawait l1.save!\n\t\tok l1.deleted?\n\t\tok !l1.exists?\n"],"names":[],"mappings":"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"}},"css":{"code":""},"warnings":[],"errors":[]}
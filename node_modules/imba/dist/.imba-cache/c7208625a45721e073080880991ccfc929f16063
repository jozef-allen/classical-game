{"js":{"code":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};;\nfunction inheritClass$__(cls){\n\tObject.getPrototypeOf(cls.prototype).constructor?.inherited?.(cls);\n};\nimport {accessor as imba_accessor} from 'imba';\nvar $1 = Symbol('name'), $2 = Symbol(), $3 = Symbol('name_fb'), $4 = Symbol(), $5 = Symbol('name_fb2'), $6 = Symbol(), $7 = Symbol(), $9, $10, $11;\nconst $__init__$ = Symbol.for('#__init__'), $__patch__$ = Symbol.for('#__patch__'), $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport setup from '../setup';\n\nclass Item extends OPObject {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $8;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($8 = $$.name) !== undefined && this.ααname.$init($8,this,$1,'name',$$);\n\t\tfields && ($8 = $$.name_fb) !== undefined && this.ααname_fb.$init($8,this,$3,'name_fb',$$);\n\t\tfields && ($8 = $$.name_fb2) !== undefined && this.ααname_fb2.$init($8,this,$5,'name_fb2',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$7 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααname.$init($$ ? $$.name : undefined,this,$1,'name',$$);\n\t\tfields && this.ααname_fb.$init($$ ? $$.name_fb : undefined,this,$3,'name_fb',$$);\n\t\tfields && this.ααname_fb2.$init($$ ? $$.name_fb2 : undefined,this,$5,'name_fb2',$$);\n\t\t\n\t}\n\tset name(val){ this.ααname.$set(val,this,$1,'name') }\n\tget name(){ return this.ααname.$get(this,$1,'name') }\n\tget ααname(){ return this[$2] || imba_accessor(($9 = this.αstring(),$9),this,$1,'name',$2,Item.prototype) }\n\tset name_fb(val){ this.ααname_fb.$set(val,this,$3,'name_fb') }\n\tget name_fb(){ return this.ααname_fb.$get(this,$3,'name_fb') }\n\tget ααname_fb(){ return this[$4] || imba_accessor(($10 = this.αstring(),($10.fallback instanceof Function) ? $10.fallback(function() { return this.name; }) : ($10.fallback = function() {\n\t\treturn this.name;\n\t}),$10),this,$3,'name_fb',$4,Item.prototype) }\n\tset name_fb2(val){ this.ααname_fb2.$set(val,this,$5,'name_fb2') }\n\tget name_fb2(){ return this.ααname_fb2.$get(this,$5,'name_fb2') }\n\tget ααname_fb2(){ return this[$6] || imba_accessor(($11 = this.αstring(),($11.fallback instanceof Function) ? $11.fallback(function() { return this.name_fb; }) : ($11.fallback = function() {\n\t\treturn this.name_fb;\n\t}),$11),this,$5,'name_fb2',$6,Item.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $7;defineName$__(this,'Item');this.alias = \"i\";\n\t\tinheritClass$__(this);}\n};\n\nawait setup(__filename,{preload: true,data: {\n\ti01: {name: 'one'},\n\ti02: {name: 'two',name_fb: 'two_fb'}\n}});\n\nlet item;\n\ntest(\"all absent\",function() {\n\t\n\titem = Item.build();\n\tok(item.name,undefined);\n\treturn ok(item.name_fb,undefined);\n});\n\ntest(\"fallback absent with @string\",function() {\n\t\n\titem = Item.build({name: \"one\"});\n\tok(item.name,\"one\");\n\treturn ok(item.name_fb,item.name);\n});\n\ntest(\"fallback present with @string\",function() {\n\t\n\titem = Item.build({name: \"one\",name_fb: \"short_one\"});\n\tok(item.name,\"one\");\n\treturn ok(item.name_fb,\"short_one\");\n});\n\ntest(\"fallback present from insertions with @string\",function({i02: i02}) {\n\t\n\tok(i02.name,'two');\n\treturn ok(i02.name_fb,'two_fb');\n});\n\ntest(\"fallback absent from insertions with @string\",function({i01: i01}) {\n\t\n\tok(i01.name,'one');\n\treturn ok(i01.name,i01.name_fb);\n});\n\ntest(\"fallback chain\",function() {\n\t\n\titem = Item.build({name: 'one'});\n\tok(item.name,'one');\n\tok(item.name_fb,item.name);\n\treturn ok(item.name_fb2,item.name);\n});\n","dependencies":[],"map":{"version":3,"file":"fallback.test.js","sourceRoot":"","sources":["/Users/sindre/repos/scrimba/op/test/misc/fallback.test.imba"],"sourcesContent":["import setup from '../setup'\n\nclass Item < OPObject\n\tstatic alias = \"i\"\n\n\tname @string\n\tname_fb @string.fallback(do name)\n\tname_fb2 @string.fallback(do name_fb)\n\nawait setup(__filename, preload: yes, data: {\n\ti01: { name: 'one' }\n\ti02: { name: 'two', name_fb: 'two_fb' }\n})\n\nlet item\n\ntest \"all absent\" do\n\titem = Item.build!\n\tok item.name, undefined\n\tok item.name_fb, undefined\n\ntest \"fallback absent with @string\" do\n\titem = Item.build { name: \"one\" }\n\tok item.name, \"one\"\n\tok item.name_fb, item.name\n\ntest \"fallback present with @string\" do\n\titem = Item.build { name: \"one\", name_fb: \"short_one\" }\n\tok item.name, \"one\"\n\tok item.name_fb, \"short_one\"\n\ntest \"fallback present from insertions with @string\" do({i02})\n\tok i02.name, 'two'\n\tok i02.name_fb, 'two_fb'\n\ntest \"fallback absent from insertions with @string\" do({i01})\n\tok i01.name, 'one'\n\tok i01.name, i01.name_fb\n\ntest \"fallback chain\" do\n\titem = Item.build { name: 'one' }\n\tok item.name, 'one'\n\tok item.name_fb, item.name\n\tok item.name_fb2, item.name\n"],"names":[],"mappings":"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"}},"css":{"code":""},"warnings":[],"errors":[]}
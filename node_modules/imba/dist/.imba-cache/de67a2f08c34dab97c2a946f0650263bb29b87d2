{"js":{"code":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};;\nfunction inheritClass$__(cls){\n\tObject.getPrototypeOf(cls.prototype).constructor?.inherited?.(cls);\n};\nimport {accessor as imba_accessor} from 'imba';\nvar $1 = Symbol('score'), $2 = Symbol(), $3 = Symbol('rank'), $4 = Symbol(), $5 = Symbol(), $6 = Symbol('score'), $7 = Symbol(), $8 = Symbol('rank'), $9 = Symbol(), $10 = Symbol('deep'), $11 = Symbol(), $12 = Symbol(), $13 = Symbol('message'), $14 = Symbol(), $15 = Symbol(), $16 = Symbol('name'), $17 = Symbol(), $18 = Symbol('num'), $19 = Symbol(), $20 = Symbol('strings'), $21 = Symbol(), $22 = Symbol('stats'), $23 = Symbol(), $24 = Symbol('commits'), $25 = Symbol(), $26 = Symbol(), $28, $29, $31, $32, $33, $35, $37, $38, $39, $40, $41;\nconst $__init__$ = Symbol.for('#__init__'), $__patch__$ = Symbol.for('#__patch__'), $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport setup from '../setup';\n\nclass DeepStats extends OPObject {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $27;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($27 = $$.score) !== undefined && this.ααscore.$init($27,this,$1,'score',$$);\n\t\tfields && ($27 = $$.rank) !== undefined && this.ααrank.$init($27,this,$3,'rank',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$5 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααscore.$init($$ ? $$.score : undefined,this,$1,'score',$$);\n\t\tfields && this.ααrank.$init($$ ? $$.rank : undefined,this,$3,'rank',$$);\n\t\t\n\t}\n\tset score(val){ this.ααscore.$set(val,this,$1,'score') }\n\tget score(){ return this.ααscore.$get(this,$1,'score') }\n\tget ααscore(){ return this[$2] || imba_accessor(($28 = this.αnumber(),$28),this,$1,'score',$2,DeepStats.prototype) }\n\tset rank(val){ this.ααrank.$set(val,this,$3,'rank') }\n\tget rank(){ return this.ααrank.$get(this,$3,'rank') }\n\tget ααrank(){ return this[$4] || imba_accessor(($29 = this.αnumber(),$29),this,$3,'rank',$4,DeepStats.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $5;defineName$__(this,'DeepStats');inheritClass$__(this);}\n};\n\nclass Stats extends OPObject {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $30;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($30 = $$.score) !== undefined && this.ααscore.$init($30,this,$6,'score',$$);\n\t\tfields && ($30 = $$.rank) !== undefined && this.ααrank.$init($30,this,$8,'rank',$$);\n\t\tfields && ($30 = $$.deep) !== undefined && this.ααdeep.$init($30,this,$10,'deep',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$12 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααscore.$init($$ ? $$.score : undefined,this,$6,'score',$$);\n\t\tfields && this.ααrank.$init($$ ? $$.rank : undefined,this,$8,'rank',$$);\n\t\tfields && this.ααdeep.$init($$ ? $$.deep : undefined,this,$10,'deep',$$);\n\t\t\n\t}\n\tset score(val){ this.ααscore.$set(val,this,$6,'score') }\n\tget score(){ return this.ααscore.$get(this,$6,'score') }\n\tget ααscore(){ return this[$7] || imba_accessor(($31 = this.αnumber(),$31),this,$6,'score',$7,Stats.prototype) }\n\tset rank(val){ this.ααrank.$set(val,this,$8,'rank') }\n\tget rank(){ return this.ααrank.$get(this,$8,'rank') }\n\tget ααrank(){ return this[$9] || imba_accessor(($32 = this.αnumber(),$32),this,$8,'rank',$9,Stats.prototype) }\n\tset deep(val){ this.ααdeep.$set(val,this,$10,'deep') }\n\tget deep(){ return this.ααdeep.$get(this,$10,'deep') }\n\tget ααdeep(){ return this[$11] || imba_accessor(($33 = this.αembed(DeepStats),$33),this,$10,'deep',$11,Stats.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $12;defineName$__(this,'Stats');inheritClass$__(this);}\n};\n\nclass Commit extends OPObject {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $34;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($34 = $$.message) !== undefined && this.ααmessage.$init($34,this,$13,'message',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$15 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααmessage.$init($$ ? $$.message : undefined,this,$13,'message',$$);\n\t\t\n\t}\n\tset message(val){ this.ααmessage.$set(val,this,$13,'message') }\n\tget message(){ return this.ααmessage.$get(this,$13,'message') }\n\tget ααmessage(){ return this[$14] || imba_accessor(($35 = this.αtext(),$35),this,$13,'message',$14,Commit.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $15;defineName$__(this,'Commit');inheritClass$__(this);}\n};\n\nexport class Scrim extends OPObject {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $36;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($36 = $$.name) !== undefined && this.ααname.$init($36,this,$16,'name',$$);\n\t\tfields && ($36 = $$.num) !== undefined && this.ααnum.$init($36,this,$18,'num',$$);\n\t\tfields && ($36 = $$.strings) !== undefined && this.ααstrings.$init($36,this,$20,'strings',$$);\n\t\tfields && ($36 = $$.stats) !== undefined && this.ααstats.$init($36,this,$22,'stats',$$);\n\t\tfields && ($36 = $$.commits) !== undefined && this.ααcommits.$init($36,this,$24,'commits',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$26 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααname.$init($$ ? $$.name : undefined,this,$16,'name',$$);\n\t\tfields && this.ααnum.$init($$ ? $$.num : undefined,this,$18,'num',$$);\n\t\tfields && this.ααstrings.$init($$ ? $$.strings : undefined,this,$20,'strings',$$);\n\t\tfields && this.ααstats.$init($$ ? $$.stats : undefined,this,$22,'stats',$$);\n\t\tfields && this.ααcommits.$init($$ ? $$.commits : undefined,this,$24,'commits',$$);\n\t\t\n\t}\n\tset name(val){ this.ααname.$set(val,this,$16,'name') }\n\tget name(){ return this.ααname.$get(this,$16,'name') }\n\tget ααname(){ return this[$17] || imba_accessor(($37 = this.αstring(),$37),this,$16,'name',$17,Scrim.prototype) }\n\tset num(val){ this.ααnum.$set(val,this,$18,'num') }\n\tget num(){ return this.ααnum.$get(this,$18,'num') }\n\tget ααnum(){ return this[$19] || imba_accessor(($38 = this.αnumber(),$38),this,$18,'num',$19,Scrim.prototype) }\n\tset strings(val){ this.ααstrings.$set(val,this,$20,'strings') }\n\tget strings(){ return this.ααstrings.$get(this,$20,'strings') }\n\tget ααstrings(){ return this[$21] || imba_accessor(($39 = this.αzset(String),$39),this,$20,'strings',$21,Scrim.prototype) }\n\tset stats(val){ this.ααstats.$set(val,this,$22,'stats') }\n\tget stats(){ return this.ααstats.$get(this,$22,'stats') }\n\tget ααstats(){ return this[$23] || imba_accessor(($40 = this.αembed(Stats),$40),this,$22,'stats',$23,Scrim.prototype) }\n\tset commits(val){ this.ααcommits.$set(val,this,$24,'commits') }\n\tget commits(){ return this.ααcommits.$get(this,$24,'commits') }\n\tget ααcommits(){ return this[$25] || imba_accessor(($41 = this.αembeds(Commit),$41),this,$24,'commits',$25,Scrim.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $26;defineName$__(this,'Scrim');this.alias = 's';\n\t\tinheritClass$__(this);}\n};\n\nlet nr = 10;\nawait setup(__filename,{e2e: true,data: {\n\ts01: {num: 1},\n\ts: async function() { return OP.$patch(await OP.db.insert((\"s0\" + (nr++)),{num: 1})); }\n}});\n\ndescribe(\"hello\",function() {\n\t\n\treturn test.web(\"simple\",function() {\n\t\t\n\t\treturn ok(10,10);\n\t});\n});\n\ntest.web(\"top\",async function() {\n\t\n\tlet s01 = OP.get('s01');\n\tawait s01;\n\treturn ok(s01.num,1);\n});\n\ntest(\"other\",function() {\n\t\n\treturn ok(100);\n});\n","dependencies":[],"map":{"version":3,"file":"universal.test.js","sourceRoot":"","sources":["/Users/sindre/repos/scrimba/op/test/core/universal.test.imba"],"sourcesContent":["import setup from '../setup'\n\nclass DeepStats < OPObject\n\tscore @number\n\trank @number\n\nclass Stats < OPObject\n\tscore @number\n\trank @number\n\tdeep @embed(DeepStats)\n\nclass Commit < OPObject\n\tmessage @text\n\nexport class Scrim < OPObject\n\tstatic alias = 's'\n\tname @string\n\tnum @number\n\tstrings @zset(String)\n\tstats @embed(Stats)\n\tcommits @embeds(Commit)\n\nlet nr = 10\nawait setup(__filename, e2e:yes, data: {\n\ts01: {num: 1}\n\ts: do OP.$patch(await OP.db.insert(\"s0{nr++}\",num: 1))\n})\n\ndescribe \"hello\" do\n\ttest.web \"simple\" do\n\t\tok 10,10\n\ntest.web \"top\" do\n\tlet s01 = OP.get('s01')\n\tawait s01\n\tok s01.num,1\n\ntest \"other\" do\n\tok 100"],"names":[],"mappings":"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"}},"css":{"code":""},"warnings":[],"errors":[]}
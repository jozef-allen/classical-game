{"js":{"code":"function defineName$__(cls,name){\n\tObject.defineProperty(cls,\"name\",{value:name,configurable:true});\n};;\nfunction inheritClass$__(cls){\n\tObject.getPrototypeOf(cls.prototype).constructor?.inherited?.(cls);\n};\nimport {accessor as imba_accessor} from 'imba';\nvar $1 = Symbol('score'), $2 = Symbol(), $3 = Symbol('rank'), $4 = Symbol(), $5 = Symbol('meta'), $6 = Symbol(), $7 = Symbol(), $8 = Symbol('score'), $9 = Symbol(), $10 = Symbol('rank'), $11 = Symbol(), $12 = Symbol('deep'), $13 = Symbol(), $14 = Symbol('meta'), $15 = Symbol(), $16 = Symbol(), $17 = Symbol('id'), $18 = Symbol(), $19 = Symbol('creator'), $20 = Symbol(), $21 = Symbol('members'), $22 = Symbol(), $23 = Symbol('users'), $24 = Symbol(), $25 = Symbol('name'), $26 = Symbol(), $27 = Symbol('desc'), $28 = Symbol(), $29 = Symbol('seen'), $30 = Symbol(), $31 = Symbol('stats'), $32 = Symbol(), $33 = Symbol(), $35, $36, $37, $39, $40, $41, $42, $44, $45, $46, $47, $48, $49, $50, $51;\nconst $__init__$ = Symbol.for('#__init__'), $__patch__$ = Symbol.for('#__patch__'), $__initor__$ = Symbol.for('#__initor__'), $__inited__$ = Symbol.for('#__inited__'), $__hooks__$ = Symbol.for('#__hooks__');\n\n/*body*/\nimport setup from './setup';\n\nclass ItemStatsDeep extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $34;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($34 = $$.score) !== undefined && this.ααscore.$init($34,this,$1,'score',$$);\n\t\tfields && ($34 = $$.rank) !== undefined && this.ααrank.$init($34,this,$3,'rank',$$);\n\t\tfields && ($34 = $$.meta) !== undefined && this.ααmeta.$init($34,this,$5,'meta',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$7 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααscore.$init($$ ? $$.score : undefined,this,$1,'score',$$);\n\t\tfields && this.ααrank.$init($$ ? $$.rank : undefined,this,$3,'rank',$$);\n\t\tfields && this.ααmeta.$init($$ ? $$.meta : undefined,this,$5,'meta',$$);\n\t\t\n\t}\n\tset score(val){ this.ααscore.$set(val,this,$1,'score') }\n\tget score(){ return this.ααscore.$get(this,$1,'score') }\n\tget ααscore(){ return this[$2] || imba_accessor(($35 = this.αnumber(),$35),this,$1,'score',$2,ItemStatsDeep.prototype) }\n\tset rank(val){ this.ααrank.$set(val,this,$3,'rank') }\n\tget rank(){ return this.ααrank.$get(this,$3,'rank') }\n\tget ααrank(){ return this[$4] || imba_accessor(($36 = this.αnumber(),$36),this,$3,'rank',$4,ItemStatsDeep.prototype) }\n\tset meta(val){ this.ααmeta.$set(val,this,$5,'meta') }\n\tget meta(){ return this.ααmeta.$get(this,$5,'meta') }\n\tget ααmeta(){ return this[$6] || imba_accessor(($37 = this.αobject(),$37),this,$5,'meta',$6,ItemStatsDeep.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $7;defineName$__(this,'ItemStatsDeep');inheritClass$__(this);}\n};\n\nclass ItemStats extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $38;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($38 = $$.score) !== undefined && this.ααscore.$init($38,this,$8,'score',$$);\n\t\tfields && ($38 = $$.rank) !== undefined && this.ααrank.$init($38,this,$10,'rank',$$);\n\t\tfields && ($38 = $$.deep) !== undefined && this.ααdeep.$init($38,this,$12,'deep',$$);\n\t\tfields && ($38 = $$.meta) !== undefined && this.ααmeta.$init($38,this,$14,'meta',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$16 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααscore.$init($$ ? $$.score : undefined,this,$8,'score',$$);\n\t\tfields && this.ααrank.$init($$ ? $$.rank : undefined,this,$10,'rank',$$);\n\t\tfields && this.ααdeep.$init($$ ? $$.deep : undefined,this,$12,'deep',$$);\n\t\tfields && this.ααmeta.$init($$ ? $$.meta : undefined,this,$14,'meta',$$);\n\t\t\n\t}\n\tset score(val){ this.ααscore.$set(val,this,$8,'score') }\n\tget score(){ return this.ααscore.$get(this,$8,'score') }\n\tget ααscore(){ return this[$9] || imba_accessor(($39 = this.αnumber(),$39),this,$8,'score',$9,ItemStats.prototype) }\n\tset rank(val){ this.ααrank.$set(val,this,$10,'rank') }\n\tget rank(){ return this.ααrank.$get(this,$10,'rank') }\n\tget ααrank(){ return this[$11] || imba_accessor(($40 = this.αnumber(),$40),this,$10,'rank',$11,ItemStats.prototype) }\n\tset deep(val){ this.ααdeep.$set(val,this,$12,'deep') }\n\tget deep(){ return this.ααdeep.$get(this,$12,'deep') }\n\tget ααdeep(){ return this[$13] || imba_accessor(($41 = this.αembed(ItemStatsDeep),$41),this,$12,'deep',$13,ItemStats.prototype) }\n\tset meta(val){ this.ααmeta.$set(val,this,$14,'meta') }\n\tget meta(){ return this.ααmeta.$get(this,$14,'meta') }\n\tget ααmeta(){ return this[$15] || imba_accessor(($42 = this.αobject(),$42),this,$14,'meta',$15,ItemStats.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $16;defineName$__(this,'ItemStats');inheritClass$__(this);}\n};\n\nexport class Item extends OP.Object {\n\t[$__patch__$]($$ = {},fields = true){\n\t\tvar $43;\n\t\tsuper[$__patch__$] && super[$__patch__$]($$,fields);\n\t\tfields && ($43 = $$.id) !== undefined && this.ααid.$init($43,this,$17,'id',$$);\n\t\tfields && ($43 = $$.creator) !== undefined && this.ααcreator.$init($43,this,$19,'creator',$$);\n\t\tfields && ($43 = $$.members) !== undefined && this.ααmembers.$init($43,this,$21,'members',$$);\n\t\tfields && ($43 = $$.users) !== undefined && this.ααusers.$init($43,this,$23,'users',$$);\n\t\tfields && ($43 = $$.name) !== undefined && this.ααname.$init($43,this,$25,'name',$$);\n\t\tfields && ($43 = $$.desc) !== undefined && this.ααdesc.$init($43,this,$27,'desc',$$);\n\t\tfields && ($43 = $$.seen) !== undefined && this.ααseen.$init($43,this,$29,'seen',$$);\n\t\tfields && ($43 = $$.stats) !== undefined && this.ααstats.$init($43,this,$31,'stats',$$);\n\t\t\n\t}\n\tconstructor(){\n\t\tsuper(...arguments);\n\t\tsuper[$__init__$] || this[$__init__$]();this[$__initor__$]===$33 && (this[$__hooks__$]&&this[$__hooks__$].inited(this),this[$__inited__$] && this[$__inited__$]());\n\t}\n\t[$__init__$]($$ = null,deep = true,fields = true){\n\t\tdeep && super[$__init__$] && super[$__init__$](...arguments);\n\t\tfields && this.ααid.$init($$ ? $$.id : undefined,this,$17,'id',$$);\n\t\tfields && this.ααcreator.$init($$ ? $$.creator : undefined,this,$19,'creator',$$);\n\t\tfields && this.ααmembers.$init($$ ? $$.members : undefined,this,$21,'members',$$);\n\t\tfields && this.ααusers.$init($$ ? $$.users : undefined,this,$23,'users',$$);\n\t\tfields && this.ααname.$init($$ ? $$.name : undefined,this,$25,'name',$$);\n\t\tfields && this.ααdesc.$init($$ ? $$.desc : undefined,this,$27,'desc',$$);\n\t\tfields && this.ααseen.$init($$ ? $$.seen : undefined,this,$29,'seen',$$);\n\t\tfields && this.ααstats.$init($$ ? $$.stats : undefined,this,$31,'stats',$$);\n\t\t\n\t}\n\tset id(val){ this.ααid.$set(val,this,$17,'id') }\n\tget id(){ return this.ααid.$get(this,$17,'id') }\n\tget ααid(){ return this[$18] || imba_accessor(($44 = this.αkey(),$44),this,$17,'id',$18,Item.prototype) }\n\tset creator(val){ this.ααcreator.$set(val,this,$19,'creator') }\n\tget creator(){ return this.ααcreator.$get(this,$19,'creator') }\n\tget ααcreator(){ return this[$20] || imba_accessor(($45 = this.αref(OP.User),($45.as instanceof Function) ? $45.as(OP.OWNER) : ($45.as = OP.OWNER),$45.default = function() {\n\t\treturn OP.user;\n\t},$45),this,$19,'creator',$20,Item.prototype) }\n\tset members(val){ this.ααmembers.$set(val,this,$21,'members') }\n\tget members(){ return this.ααmembers.$get(this,$21,'members') }\n\tget ααmembers(){ return this[$22] || imba_accessor(($46 = this.αitems(OP.User),($46.as instanceof Function) ? $46.as(OP.MEMBER) : ($46.as = OP.MEMBER),$46),this,$21,'members',$22,Item.prototype) }\n\tset users(val){ this.ααusers.$set(val,this,$23,'users') }\n\tget users(){ return this.ααusers.$get(this,$23,'users') }\n\tget ααusers(){ return this[$24] || imba_accessor(($47 = this.αzset(OP.User),$47),this,$23,'users',$24,Item.prototype) }\n\tset name(val){ this.ααname.$set(val,this,$25,'name') }\n\tget name(){ return this.ααname.$get(this,$25,'name') }\n\tget ααname(){ return this[$26] || imba_accessor(($48 = this.αstring(),$48),this,$25,'name',$26,Item.prototype) }\n\tset desc(val){ this.ααdesc.$set(val,this,$27,'desc') }\n\tget desc(){ return this.ααdesc.$get(this,$27,'desc') }\n\tget ααdesc(){ return this[$28] || imba_accessor(($49 = this.αstring(),$49),this,$27,'desc',$28,Item.prototype) }\n\tset seen(val){ this.ααseen.$set(val,this,$29,'seen') }\n\tget seen(){ return this.ααseen.$get(this,$29,'seen') }\n\tget ααseen(){ return this[$30] || imba_accessor(($50 = this.αnumber(),($50.pov instanceof Function) ? $50.pov() : ($50.pov = true),$50),this,$29,'seen',$30,Item.prototype) }\n\tset stats(val){ this.ααstats.$set(val,this,$31,'stats') }\n\tget stats(){ return this.ααstats.$get(this,$31,'stats') }\n\tget ααstats(){ return this[$32] || imba_accessor(($51 = this.αembed(ItemStats),$51),this,$31,'stats',$32,Item.prototype) }\n\tstatic {\n\t\tthis.prototype[$__initor__$] = $33;defineName$__(this,'Item');inheritClass$__(this);}\n};\n\nawait setup(__filename);\n\n// TODO support test.extend on client - and in imba spec as well?\nconst check = test.extend({\n\titem: async function({task: task},use) {\n\t\t\n\t\treturn await use(OP.get(task.name));\n\t},\n\t\n\tuser: async function({task: task},use) {\n\t\t\n\t\treturn await use(await OP.User.create());\n\t}\n});\n\ncheck(`item01.stats.deep.score`,function({item: item}) {\n\t\n\t\n\tok(item instanceof OPField);\n\tok(item.name,'score');\n\tok(item.$path,'stats.deep.score');\n\treturn ok(item.$root.$type,Item);\n});\n\ncheck(`item01.stats`,function({item: item}) {\n\t\n\tok(item instanceof ItemStats);\n\tok(item.$path,'stats');\n\treturn ok(item.$root.$type,Item);\n});\n\ncheck(`item01.U02`,function({item: item}) {\n\t\n\tok(item.$path,null);\n\treturn ok(item.$root instanceof OPPov);\n});\n\ncheck(`item01.U02.desc`,function({item: item}) {\n\t\n\t// This path does not exist according to models/schema\n\treturn ok(item,null);\n});\n","dependencies":[],"map":{"version":3,"file":"path.test.js","sourceRoot":"","sources":["/Users/sindre/repos/scrimba/op/test/path.test.imba"],"sourcesContent":["import setup from './setup'\n\nclass ItemStatsDeep < OP.Object\n\tscore @number\n\trank @number\n\tmeta @object\n\nclass ItemStats < OP.Object\n\tscore @number\n\trank @number\n\tdeep @embed(ItemStatsDeep)\n\tmeta @object\n\nexport class Item < OP.Object\n\tid @key\n\tcreator @ref(OP.User).as(OP.OWNER) = OP.user\n\tmembers @items(OP.User).as(OP.MEMBER)\n\tusers @zset(OP.User)\n\tname @string\n\tdesc @string\n\tseen @number.pov\n\tstats @embed(ItemStats)\n\nawait setup(__filename)\n\n# TODO support test.extend on client - and in imba spec as well?\nconst check = test.extend({\n\titem: do({task},use)\n\t\tawait use(OP.get(task.name))\n\n\tuser: do({task},use)\n\t\tawait use(await OP.User.create!)\n\n})\n\ncheck `item01.stats.deep.score` do({item})\n\n\tok item isa OPField\n\tok item.name, 'score'\n\tok item.$path,'stats.deep.score'\n\tok item.$root.$type,Item\n\ncheck `item01.stats` do({item})\n\tok item isa ItemStats\n\tok item.$path,'stats'\n\tok item.$root.$type,Item\n\ncheck `item01.U02` do({item})\n\tok item.$path,null\n\tok item.$root isa OPPov\n\ncheck `item01.U02.desc` do({item})\n\t# This path does not exist according to models/schema\n\tok item, null"],"names":[],"mappings":"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"}},"css":{"code":""},"warnings":[],"errors":[]}